{% extends "base.html" %}

{% block title %}í™ˆ - ìœ ëŸ‰ì¸¡ì • ì‹œìŠ¤í…œ{% endblock %}

{% block content %}
<div class="max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8">
    <!-- Header -->
    <div class="mb-8">
        <h1 class="text-2xl font-bold text-gray-900">ìœ ëŸ‰ì¸¡ì • ë¶ˆí™•ì‹¤ë„ ë¶„ì„ ì‹œìŠ¤í…œ</h1>
        <p class="mt-1 text-gray-600">ISO 748 í‘œì¤€ ê¸°ë°˜ì˜ í•˜ì²œ ìœ ëŸ‰ ì¸¡ì • ë° ë¶ˆí™•ì‹¤ë„ ë¶„ì„</p>
    </div>

    <!-- Quick Stats & Actions -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8">
        <!-- Quick Start -->
        <div class="bg-gradient-to-br from-primary-500 to-primary-600 rounded-xl p-5 text-white shadow-lg">
            <h3 class="font-semibold mb-3">ë¹ ë¥¸ ì‹œì‘</h3>
            <div class="space-y-2">
                <a href="{% url 'measurement:new' %}" class="flex items-center justify-between p-2 bg-white/20 rounded-lg hover:bg-white/30 transition">
                    <span class="text-sm">ìƒˆ ì¸¡ì • ì‹œì‘</span>
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                    </svg>
                </a>
                <a href="{% url 'measurement:pre_uncertainty' %}" class="flex items-center justify-between p-2 bg-white/20 rounded-lg hover:bg-white/30 transition">
                    <span class="text-sm">ì‚¬ì „ ë¶ˆí™•ì‹¤ë„ ë¶„ì„</span>
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                    </svg>
                </a>
            </div>
        </div>

        <!-- Recent Stats -->
        <div class="bg-white rounded-xl p-5 shadow-sm border">
            <div class="flex items-center justify-between mb-3">
                <h3 class="font-semibold text-gray-700">ì´ë²ˆ ë‹¬ ì¸¡ì •</h3>
                <span class="text-2xl">ğŸ“Š</span>
            </div>
            <p class="text-3xl font-bold text-gray-900">{{ monthly_count|default:"0" }}íšŒ</p>
            <p class="text-sm text-gray-500 mt-1">ì´ {{ total_count|default:"0" }}íšŒ ê¸°ë¡</p>
        </div>

        <!-- Average Discharge -->
        <div class="bg-white rounded-xl p-5 shadow-sm border">
            <div class="flex items-center justify-between mb-3">
                <h3 class="font-semibold text-gray-700">í‰ê·  ìœ ëŸ‰</h3>
                <span class="text-2xl">ğŸŒŠ</span>
            </div>
            <p class="text-3xl font-bold text-gray-900">{{ avg_discharge|default:"--" }} <span class="text-lg font-normal">mÂ³/s</span></p>
            <p class="text-sm text-gray-500 mt-1">ì´ë²ˆ ë‹¬ í‰ê· </p>
        </div>

        <!-- Average Uncertainty -->
        <div class="bg-white rounded-xl p-5 shadow-sm border">
            <div class="flex items-center justify-between mb-3">
                <h3 class="font-semibold text-gray-700">í‰ê·  ë¶ˆí™•ì‹¤ë„</h3>
                <span class="text-2xl">ğŸ“ˆ</span>
            </div>
            <p class="text-3xl font-bold text-gray-900">Â±{{ avg_uncertainty|default:"--" }}<span class="text-lg font-normal">%</span></p>
            <p class="text-sm text-gray-500 mt-1">95% ì‹ ë¢°ìˆ˜ì¤€</p>
        </div>
    </div>

    <!-- Main Content Grid -->
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
        <!-- Recent Measurements -->
        <div class="lg:col-span-2 bg-white rounded-xl shadow-sm border">
            <div class="px-5 py-4 border-b flex items-center justify-between">
                <h2 class="font-semibold text-gray-900">ìµœê·¼ ì¸¡ì •</h2>
                <a href="{% url 'measurement:list' %}" class="text-sm text-primary-600 hover:text-primary-700">ì „ì²´ ë³´ê¸° â†’</a>
            </div>
            <div class="divide-y">
                {% if recent_measurements %}
                    {% for m in recent_measurements %}
                    <a href="{% url 'measurement:detail' m.id %}" class="flex items-center justify-between px-5 py-4 hover:bg-gray-50 transition">
                        <div class="flex items-center space-x-4">
                            <div class="w-10 h-10 rounded-full bg-primary-100 flex items-center justify-center">
                                <svg class="w-5 h-5 text-primary-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/>
                                </svg>
                            </div>
                            <div>
                                <p class="font-medium text-gray-900">{{ m.river_name }} {{ m.station_name }}</p>
                                <p class="text-sm text-gray-500">{{ m.measurement_date|date:"Y-m-d" }}</p>
                            </div>
                        </div>
                        <div class="text-right">
                            <p class="font-semibold text-gray-900">{{ m.discharge|floatformat:3 }} mÂ³/s</p>
                            <p class="text-sm text-gray-500">Â±{{ m.uncertainty|floatformat:1 }}%</p>
                        </div>
                    </a>
                    {% endfor %}
                {% else %}
                    <div class="px-5 py-12 text-center">
                        <svg class="w-12 h-12 mx-auto text-gray-300 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"/>
                        </svg>
                        <p class="text-gray-500 mb-4">ì•„ì§ ì¸¡ì • ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤</p>
                        <a href="{% url 'measurement:new' %}" class="inline-flex items-center px-4 py-2 bg-primary-600 text-white text-sm font-medium rounded-lg hover:bg-primary-700">
                            ì²« ì¸¡ì • ì‹œì‘í•˜ê¸°
                        </a>
                    </div>
                {% endif %}
            </div>
        </div>

        <!-- System Info & Help -->
        <div class="space-y-6">
            <!-- System Info -->
            <div class="bg-white rounded-xl shadow-sm border p-5">
                <h2 class="font-semibold text-gray-900 mb-4">ì‹œìŠ¤í…œ ì •ë³´</h2>
                <dl class="space-y-3 text-sm">
                    <div class="flex justify-between">
                        <dt class="text-gray-500">ì¸¡ì • ë°©ë²•</dt>
                        <dd class="text-gray-900">1ì , 2ì , 3ì ë²•</dd>
                    </div>
                    <div class="flex justify-between">
                        <dt class="text-gray-500">ê³„ì‚° ë°©ì‹</dt>
                        <dd class="text-gray-900">ì¤‘ì•™ë‹¨ë©´ë²•</dd>
                    </div>
                    <div class="flex justify-between">
                        <dt class="text-gray-500">ë¶ˆí™•ì‹¤ë„ í‘œì¤€</dt>
                        <dd class="text-gray-900">ISO 748</dd>
                    </div>
                    <div class="flex justify-between">
                        <dt class="text-gray-500">ìœ ì†ê³„ ì§€ì›</dt>
                        <dd class="text-gray-900">ìµœëŒ€ 4ê°œ</dd>
                    </div>
                </dl>
            </div>

            <!-- Quick Links -->
            <div class="bg-white rounded-xl shadow-sm border p-5">
                <h2 class="font-semibold text-gray-900 mb-4">ê¸°ëŠ¥ ì•ˆë‚´</h2>
                <div class="space-y-2">
                    <div class="flex items-start space-x-3 p-3 rounded-lg bg-blue-50">
                        <span class="text-blue-500 mt-0.5">ğŸ“Š</span>
                        <div>
                            <p class="font-medium text-blue-900">ì¸¡ì • ì…ë ¥</p>
                            <p class="text-sm text-blue-700">ì¸¡ì„ ë³„ ìˆ˜ì‹¬, ìœ ì† ë°ì´í„° ì…ë ¥</p>
                        </div>
                    </div>
                    <div class="flex items-start space-x-3 p-3 rounded-lg bg-green-50">
                        <span class="text-green-500 mt-0.5">ğŸ§®</span>
                        <div>
                            <p class="font-medium text-green-900">ìœ ëŸ‰ ê³„ì‚°</p>
                            <p class="text-sm text-green-700">Mid-Section Method ìë™ ì ìš©</p>
                        </div>
                    </div>
                    <div class="flex items-start space-x-3 p-3 rounded-lg bg-amber-50">
                        <span class="text-amber-500 mt-0.5">ğŸ“ˆ</span>
                        <div>
                            <p class="font-medium text-amber-900">ë¶ˆí™•ì‹¤ë„ ë¶„ì„</p>
                            <p class="text-sm text-amber-700">ISO 748 í‘œì¤€ ì¤€ìˆ˜</p>
                        </div>
                    </div>
                    <div class="flex items-start space-x-3 p-3 rounded-lg bg-purple-50">
                        <span class="text-purple-500 mt-0.5">ğŸ“„</span>
                        <div>
                            <p class="font-medium text-purple-900">ë³´ê³ ì„œ ì¶œë ¥</p>
                            <p class="text-sm text-purple-700">PDF/Excel ë‹¤ìš´ë¡œë“œ</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
