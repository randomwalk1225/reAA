# VBA Quick Reference Card

빠른 참조용 VBA 함수 요약

---

## Module1.bas - 핵심 계산

| 함수 | 위치 | 목적 | 파라미터 |
|------|------|------|----------|
| `mainCalFlow()` | Line 1-45 | 계산 진입점 | 없음 |
| `calFlow(num)` | Line 48-600 | 유량/불확실도 계산 | num: 1 or 2 |
| `calDepth(depth, cal)` | Line 630-680 | 측정깊이 계산 | depth: 수심, cal: 1/2/3 |
| `fnaveVel(N, T, Meter)` | Line 700-800 | 유속 계산 | N: 회전수, T: 시간 |
| `fmVel(method, v1, v2, v3)` | Line 820-870 | 평균유속 | method: 1/2/3점법 |
| `Xe_Error(m)` | Line 900-950 | 측점 불확실도 | m: 측선수 |
| `Xp_Error(d, s)` | Line 960-1020 | 깊이 불확실도 | d: 수심, s: 표면상태 |
| `Xc_Error(meter)` | Line 1030-1100 | 검정 불확실도 | meter: 유속계명 |
| `Xm_Error(t, m, v)` | Line 1110-1200 | 측정 불확실도 | t: 시간, m: 방법, v: 유속 |
| `fnaveVelE(N, T)` | Line 1300-1400 | 가장자리 유속 | N: 회전수, T: 시간 |

---

## Module2.bas - 보조 기능

| 함수 | 위치 | 목적 |
|------|------|------|
| `거리계산()` | Line 11-61 | 구간거리→누가거리 변환 |
| `지점입력()` | Line 63-105 | 관측소 검색 |
| `유속계입력()` | Line 106-389 | 측선별 유속계 배정 |

---

## 핵심 공식

### 유속
```
V = a + b × (N/T)
```

### 평균유속
```
1점법: V̄ = V₀.₆
2점법: V̄ = (V₀.₂ + V₀.₈) / 2
3점법: V̄ = (V₀.₂ + 2×V₀.₆ + V₀.₈) / 4
```

### 유량 (Mid-Section)
```
Q = Σ[(b(i+1) - b(i-1))/2 × d(i) × V̄(i)]
```

### 불확실도 (ISO 748)
```
U = 2 × √(Xe² + Xp² + Xc² + Xm²)
```

---

## 측정법 결정 기준

| 수심 (m) | 측정법 | 깊이 |
|----------|--------|------|
| < 0.6 | 1점법 | 0.6D |
| 0.6 - 1.0 | 2점법 | 0.2D, 0.8D |
| >= 1.0 | 3점법 | 0.2D, 0.6D, 0.8D |

---

## 시트 매핑

| 시트 | 용도 |
|------|------|
| 입력시트 | 데이터 입력 UI |
| 입력저장1/2 | 원시 데이터 저장 |
| 계산1/2 | 유속/유량 계산 |
| 불확실도1/2 | 불확실도 분석 |
| 평균 | 2회 측정 평균 |
| 종합 | 최종 보고서 |
| para | 검정계수/조견표 |

---

## 유속계 측선 지정 형식

```
단일: "3"
범위: "1-5"
역순: "5-1"
혼합: "1-5,7,9-12"
```

---

## 데이터 흐름

```
기본입력 → 입력시트 → 입력저장 → 계산 → 불확실도 → 평균 → 종합
```

---

*Quick Reference v1.0*
